// Scales
// ======

@import 'units';
@import 'math';


// Get Size
// --------
@function _get-size(
  $size
) {
  $size: map-get($sizes, $size) or $size;

  @if map-has-key($sizes, $size) {
    $size: _get-size($size);
  }

  @return $size;
}


// Get Ratio
// ---------
@function _get-ratio(
  $ratio: $ratio
) {
  $ratio: map-get($_ratio-options, $ratio) or $ratio;

  @if map-has-key($_ratio-options, $ratio) {
    $ratio: _get-ratio($ratio);
  }

  @return $ratio;
}


// Size
// ----
@function size(
  $size,
  $unit: $rhythm-unit
) {
  $size: _get-size($size);

  @if type-of($size) == number {
    @if unitless($size) {
      $_ratio: _get-ratio($ratio);
      @if $_ratio == 'linear' {
        $size: $base-size * $size;
      } @else {
        $size: round($base-size * pow($_ratio, $size));
      }
    }

    $size: convert-length($size, $unit);
  }

  @return $size;
}


// Get Lines
// ---------
@function _get-lines(
  $size: normal,
  $rhythm: rhythm
) {
  $font-size: size($size, px);
  $line-height: size($rhythm, px);

  @return ceil(2 * $font-size / $line-height) / 2;
}


// Font Size
// ---------
@mixin font-size(
  $size: normal,
  $lines: false
) {
  font-size: size($size);
  line-height: if($lines, $lines, _get-lines($size)) * size(rhythm);
}


// Square
// ------
@mixin square($size) {
  $size: size($size);

  height: $size;
  width: $size;
}


// Establish Baseline
@mixin baseline(
  $base-size: $base-size,
  $ratio: $ratio
) {
  font-size: percentage($base-size / $_browser-default-font-size);
  line-height: size(rhythm, em);
}
